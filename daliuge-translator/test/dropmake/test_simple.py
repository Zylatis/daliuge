#
#    ICRAR - International Centre for Radio Astronomy Research
#    (c) UWA - The University of Western Australia, 2020
#    Copyright by UWA (in the framework of the ICRAR)
#    All rights reserved
#
#    This library is free software; you can redistribute it and/or
#    modify it under the terms of the GNU Lesser General Public
#    License as published by the Free Software Foundation; either
#    version 2.1 of the License, or (at your option) any later version.
#
#    This library is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
#    Lesser General Public License for more details.
#
#    You should have received a copy of the GNU Lesser General Public
#    License along with this library; if not, write to the Free Software
#    Foundation, Inc., 59 Temple Place, Suite 330, Boston,
#    MA 02111-1307  USA

import unittest

from bottle import FormsDict

from dlg.dropmake import simple_translator

TEST_01_SIMPLE_IN = {
    "modelData": {
        "fileType": "graph",
        "repoService": "GitHub",
        "repo": "ICRAR/EAGLE_test_repo",
        "filePath": "simple_tests/simple_01_basic.graph",
        "sha": "Dummy",
        "git_url": "Dummy",
    },
    "nodeDataArray": [
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -1,
            "text": "Memory",
            "description": "",
            "loc": "245 349",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [],
            "outputPorts": [
                {"Id": "eba8f9fd-259b-4bd3-bc5e-b17be45aae6e", "IdText": "event"}
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -2,
            "text": "Memory",
            "description": "",
            "loc": "978 346",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "279ee7d5-fcd1-4871-8a5b-91bfcbcb5d12", "IdText": "event"}
            ],
            "outputPorts": [],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "Component",
            "categoryType": "Application",
            "isData": False,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#3498DB",
            "key": -3,
            "text": "Python Sleep App",
            "description": "Python Sleep App",
            "loc": "615 349",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "4de79720-e16d-4eb1-aec6-79a994a8e819", "IdText": "event"}
            ],
            "outputPorts": [
                {"Id": "fbafc3ba-8c0c-4b0e-b88a-541cf228248d", "IdText": "event"}
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Execution time", "name": "execution_time", "value": "5"},
                {"text": "Num CPUs", "name": "num_cpus", "value": "1"},
                {"text": "Group start", "name": "group_start", "value": "0"},
                {"text": "Appclass", "name": "appclass", "value": "dlg.apps.SleepApp"},
                {"text": "Arg01", "name": "arg01", "value": "sleep time=10"},
            ],
        },
        {
            "category": "Comment",
            "categoryType": "Control",
            "isData": False,
            "isGroup": False,
            "canHaveInputs": False,
            "canHaveOutputs": False,
            "colour": "#799938",
            "key": -4,
            "text": "Comment",
            "description": "",
            "loc": "518 240",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [],
            "outputPorts": [],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {
                    "text": "",
                    "name": "",
                    "value": "The simplest graph I can make.\nA start, an end and a Sleep",
                }
            ],
            "desiredSize": {"width": 386, "height": 50},
        },
    ],
    "linkDataArray": [
        {
            "from": -1,
            "fromPort": "eba8f9fd-259b-4bd3-bc5e-b17be45aae6e",
            "to": -3,
            "toPort": "4de79720-e16d-4eb1-aec6-79a994a8e819",
        },
        {
            "from": -3,
            "fromPort": "fbafc3ba-8c0c-4b0e-b88a-541cf228248d",
            "to": -2,
            "toPort": "279ee7d5-fcd1-4871-8a5b-91bfcbcb5d12",
        },
    ],
}
TEST_01_SIMPLE_PGT = [
    {
        "oid": "2020-05-08T08:39:41_-1_0",
        "type": "plain",
        "storage": "memory",
        "rank": [0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0",
        "lg_key": -1,
        "dt": "memory",
        "nm": "Memory",
        "consumers": ["2020-05-08T08:39:41_-3_0"],
    },
    {
        "oid": "2020-05-08T08:39:41_-2_0",
        "type": "plain",
        "storage": "memory",
        "rank": [0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0",
        "lg_key": -2,
        "dt": "memory",
        "nm": "Memory",
        "producers": ["2020-05-08T08:39:41_-3_0"],
    },
    {
        "oid": "2020-05-08T08:39:41_-3_0",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T08:39:41_-1_0"],
        "outputs": ["2020-05-08T08:39:41_-2_0"],
    },
]
TEST_02_SIMPLE_IN = {
    "modelData": {
        "fileType": "graph",
        "repoService": "GitHub",
        "repo": "ICRAR/EAGLE_test_repo",
        "filePath": "simple_tests/simple_02_mkn.graph",
        "sha": "Dummy",
        "git_url": "Dummy",
    },
    "nodeDataArray": [
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -4,
            "text": "Memory",
            "description": "",
            "loc": "212 291",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [],
            "outputPorts": [
                {"Id": "082a2c9e-e282-4658-8b10-64d4034a6813", "IdText": "event"}
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -5,
            "text": "Memory",
            "description": "",
            "loc": "1348 289",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "65580ecc-b5fd-4c1c-8bda-b9543c67dde7", "IdText": "event"}
            ],
            "outputPorts": [],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "MKN",
            "categoryType": "Group",
            "isData": False,
            "isGroup": True,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#D32000",
            "key": -6,
            "text": "MKN",
            "description": "Placeholder 'mkn' description",
            "loc": "346 268",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "mkn_in",
            "outputAppName": "mkn_out",
            "exitAppName": "",
            "inputApplication": "Component",
            "outputApplication": "Component",
            "inputPorts": [
                {"Id": "a199ff5c-7843-4dd1-84aa-46e0ea627d92", "IdText": "event"}
            ],
            "outputPorts": [
                {"Id": "0052c99f-6884-42f5-ab4c-4ac9d0470874", "IdText": "event"}
            ],
            "inputLocalPorts": [
                {"Id": "e7152607-640e-471a-96d9-655816d82b2f", "IdText": "end"}
            ],
            "outputLocalPorts": [
                {"Id": "c67cd47e-395b-451a-bca8-27da62f132f0", "IdText": "start"}
            ],
            "inputAppFields": [
                {"text": "Execution time", "name": "execution_time", "value": "5"},
                {"text": "Num CPUs", "name": "num_cpus", "value": "1"},
                {"text": "Group start", "name": "group_start", "value": "0"},
                {
                    "text": "Appclass",
                    "name": "appclass",
                    "value": "test.graphsRepository",
                },
            ],
            "outputAppFields": [
                {"text": "Execution time", "name": "execution_time", "value": "5"},
                {"text": "Num CPUs", "name": "num_cpus", "value": "1"},
                {"text": "Group start", "name": "group_start", "value": "0"},
                {
                    "text": "Appclass",
                    "name": "appclass",
                    "value": "test.graphsRepository",
                },
            ],
            "fields": [
                {"text": "M", "name": "m", "value": "1"},
                {"text": "K", "name": "k", "value": "10"},
                {"text": "N", "name": "n", "value": "1"},
            ],
            "desiredSize": {"width": 823.7560975609755, "height": 426.4748923959828},
        },
        {
            "category": "Component",
            "categoryType": "Application",
            "isData": False,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#3498DB",
            "key": -3,
            "text": "Python Sleep App",
            "description": "An application component in the form of a Python app",
            "loc": "812 435",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "group": -6,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "3278a8d9-199e-4758-8a64-33c1ed01e0d9", "IdText": "event"},
                {"Id": "49dc059c-33b4-4f07-889c-24a6be429b36", "IdText": "link"},
            ],
            "outputPorts": [
                {"Id": "fc34b3c8-bd24-4706-a07c-569a61381615", "IdText": "event"},
                {"Id": "06dfa79e-be7f-4908-8418-864884108864", "IdText": "end"},
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Execution time", "name": "execution_time", "value": "5"},
                {"text": "Num CPUs", "name": "num_cpus", "value": "1"},
                {"text": "Group start", "name": "group_start", "value": "0"},
                {"text": "Appclass", "name": "appclass", "value": "dlg.apps.SleepApp"},
                {"text": "sleep_time", "name": "sleep_time", "value": "10"},
            ],
        },
        {
            "category": "Component",
            "categoryType": "Application",
            "isData": False,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#3498DB",
            "key": -2,
            "text": "Python Sleep App",
            "description": "An application component in the form of a Python app",
            "loc": "453 398",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "group": -6,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "3278a8d9-199e-4758-8a64-33c1ed01e0d9", "IdText": "event"},
                {"Id": "01bd22b3-9018-48f6-948e-89428936a99b", "IdText": "start"},
            ],
            "outputPorts": [
                {"Id": "fc34b3c8-bd24-4706-a07c-569a61381615", "IdText": "event"},
                {"Id": "1442ac73-a7e6-4c4c-a9fd-9620ac52e3b1", "IdText": "link"},
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Execution time", "name": "execution_time", "value": "5"},
                {"text": "Num CPUs", "name": "num_cpus", "value": "1"},
                {"text": "Group start", "name": "group_start", "value": "0"},
                {"text": "Appclass", "name": "appclass", "value": "dlg.apps.SleepApp"},
                {"text": "sleep time", "name": "sleep_time", "value": "10"},
            ],
        },
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -1,
            "text": "end",
            "description": "",
            "loc": "1042 359",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "group": -6,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "ddd6dbe5-2f97-4e79-9aa0-d622c8fb1594", "IdText": "event"},
                {"Id": "63b80621-02cb-43ad-b056-076a67128bd7", "IdText": "end"},
            ],
            "outputPorts": [
                {"Id": "2e8ac895-e276-41ca-b43e-4d749d74d30e", "IdText": "event"},
                {"Id": "34d34c51-d1d1-4f2f-98ec-2b38d53e459e", "IdText": "end"},
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -8,
            "text": "start",
            "description": "",
            "loc": "374 385",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "group": -6,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "ddd6dbe5-2f97-4e79-9aa0-d622c8fb1594", "IdText": "event"},
                {"Id": "4dd6e534-4efa-4558-8918-b4cd7be628fb", "IdText": "start"},
            ],
            "outputPorts": [
                {"Id": "2e8ac895-e276-41ca-b43e-4d749d74d30e", "IdText": "event"},
                {"Id": "4e58f527-45e2-4e3a-92f4-c3e6a9ebca0a", "IdText": "start"},
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "memory",
            "categoryType": "Data",
            "isData": True,
            "isGroup": False,
            "canHaveInputs": True,
            "canHaveOutputs": True,
            "colour": "#394BB2",
            "key": -9,
            "text": "link",
            "description": "",
            "loc": "707 507",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "group": -6,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [
                {"Id": "ddd6dbe5-2f97-4e79-9aa0-d622c8fb1594", "IdText": "event"},
                {"Id": "8aa39378-fdbe-49a5-9cb5-5bc341c64146", "IdText": "link"},
            ],
            "outputPorts": [
                {"Id": "2e8ac895-e276-41ca-b43e-4d749d74d30e", "IdText": "event"},
                {"Id": "533322fa-54b7-4d55-8317-ec239ce92e6d", "IdText": "link"},
            ],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [
                {"text": "Data volume", "name": "data_volume", "value": "5"},
                {"text": "Group end", "name": "group_end", "value": "0"},
            ],
        },
        {
            "category": "Comment",
            "categoryType": "Control",
            "isData": False,
            "isGroup": False,
            "canHaveInputs": False,
            "canHaveOutputs": False,
            "colour": "#799938",
            "key": -7,
            "text": "Comment",
            "description": "",
            "loc": "632 181",
            "collapsed": False,
            "streaming": False,
            "subject": None,
            "inputAppName": "",
            "outputAppName": "",
            "exitAppName": "",
            "inputApplication": "Unknown",
            "outputApplication": "Unknown",
            "inputPorts": [],
            "outputPorts": [],
            "inputLocalPorts": [],
            "outputLocalPorts": [],
            "inputAppFields": [],
            "outputAppFields": [],
            "fields": [{"text": "", "name": "", "value": "Simple MKN node test"}],
            "desiredSize": {"width": 265, "height": 62},
        },
    ],
    "linkDataArray": [
        {
            "from": -4,
            "fromPort": "082a2c9e-e282-4658-8b10-64d4034a6813",
            "to": -6,
            "toPort": "a199ff5c-7843-4dd1-84aa-46e0ea627d92",
        },
        {
            "from": -6,
            "fromPort": "0052c99f-6884-42f5-ab4c-4ac9d0470874",
            "to": -5,
            "toPort": "65580ecc-b5fd-4c1c-8bda-b9543c67dde7",
        },
        {
            "from": -3,
            "fromPort": "06dfa79e-be7f-4908-8418-864884108864",
            "to": -1,
            "toPort": "63b80621-02cb-43ad-b056-076a67128bd7",
        },
        {
            "from": -1,
            "fromPort": "34d34c51-d1d1-4f2f-98ec-2b38d53e459e",
            "to": -6,
            "toPort": "e7152607-640e-471a-96d9-655816d82b2f",
        },
        {
            "from": -6,
            "fromPort": "c67cd47e-395b-451a-bca8-27da62f132f0",
            "to": -8,
            "toPort": "4dd6e534-4efa-4558-8918-b4cd7be628fb",
        },
        {
            "from": -8,
            "fromPort": "4e58f527-45e2-4e3a-92f4-c3e6a9ebca0a",
            "to": -2,
            "toPort": "01bd22b3-9018-48f6-948e-89428936a99b",
        },
        {
            "from": -3,
            "fromPort": "49dc059c-33b4-4f07-889c-24a6be429b36",
            "to": -9,
            "toPort": "8aa39378-fdbe-49a5-9cb5-5bc341c64146",
        },
        {
            "from": -9,
            "fromPort": "533322fa-54b7-4d55-8317-ec239ce92e6d",
            "to": -2,
            "toPort": "1442ac73-a7e6-4c4c-a9fd-9620ac52e3b1",
        },
    ],
}
TEST_02_SIMPLE_PGT = [
    {
        "oid": "2020-05-08T09:27:47_-4_0",
        "type": "plain",
        "storage": "memory",
        "rank": [0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0",
        "lg_key": -4,
        "dt": "memory",
        "nm": "Memory",
        "consumers": ["2020-05-08T09:27:47_-6_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/0",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/0",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/0", "2020-05-08T09:27:47_-9_0/0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/1",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 1],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/1",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/1", "2020-05-08T09:27:47_-9_0/0/1"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/2",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 2],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/2",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/2", "2020-05-08T09:27:47_-9_0/0/2"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/3",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 3],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/3",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/3", "2020-05-08T09:27:47_-9_0/0/3"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/4",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 4],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/4",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/4", "2020-05-08T09:27:47_-9_0/0/4"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/5",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 5],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/5",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/5", "2020-05-08T09:27:47_-9_0/0/5"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/6",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 6],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/6",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/6", "2020-05-08T09:27:47_-9_0/0/6"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/7",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 7],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/7",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/7", "2020-05-08T09:27:47_-9_0/0/7"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/8",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 8],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/8",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/8", "2020-05-08T09:27:47_-9_0/0/8"],
    },
    {
        "oid": "2020-05-08T09:27:47_-3_0/0/9",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 9],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/9",
        "lg_key": -3,
        "dt": "Component",
        "nm": "Python Sleep App",
        "outputs": ["2020-05-08T09:27:47_-1_0/0/9", "2020-05-08T09:27:47_-9_0/0/9"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/0",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/0",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/0", "2020-05-08T09:27:47_-9_0/0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/1",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 1],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/1",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/1", "2020-05-08T09:27:47_-9_0/0/1"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/2",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 2],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/2",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/2", "2020-05-08T09:27:47_-9_0/0/2"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/3",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 3],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/3",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/3", "2020-05-08T09:27:47_-9_0/0/3"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/4",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 4],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/4",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/4", "2020-05-08T09:27:47_-9_0/0/4"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/5",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 5],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/5",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/5", "2020-05-08T09:27:47_-9_0/0/5"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/6",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 6],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/6",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/6", "2020-05-08T09:27:47_-9_0/0/6"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/7",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 7],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/7",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/7", "2020-05-08T09:27:47_-9_0/0/7"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/8",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 8],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/8",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/8", "2020-05-08T09:27:47_-9_0/0/8"],
    },
    {
        "oid": "2020-05-08T09:27:47_-2_0/0/9",
        "type": "app",
        "app": "dlg.apps.SleepApp",
        "rank": [0, 0, 9],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "iid": "0/0/9",
        "lg_key": -2,
        "dt": "Component",
        "nm": "Python Sleep App",
        "inputs": ["2020-05-08T09:27:47_-8_0/0/9", "2020-05-08T09:27:47_-9_0/0/9"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/0",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/0",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/0"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/1",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 1],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/1",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/1"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/2",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 2],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/2",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/2"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/3",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 3],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/3",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/3"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/4",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 4],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/4",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/4"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/5",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 5],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/5",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/5"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/6",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 6],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/6",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/6"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/7",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 7],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/7",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/7"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/8",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 8],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/8",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/8"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-1_0/0/9",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 9],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/9",
        "lg_key": -1,
        "dt": "memory",
        "nm": "end",
        "producers": ["2020-05-08T09:27:47_-3_0/0/9"],
        "consumers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/0",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/0",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/1",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 1],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/1",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/1"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/2",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 2],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/2",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/2"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/3",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 3],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/3",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/3"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/4",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 4],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/4",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/4"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/5",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 5],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/5",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/5"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/6",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 6],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/6",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/6"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/7",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 7],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/7",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/7"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/8",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 8],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/8",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/8"],
    },
    {
        "oid": "2020-05-08T09:27:47_-8_0/0/9",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 9],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/9",
        "lg_key": -8,
        "dt": "memory",
        "nm": "start",
        "producers": ["2020-05-08T09:27:47_-6_0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/9"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/0",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/0",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/0"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/1",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 1],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/1",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/1"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/1"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/2",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 2],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/2",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/2"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/2"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/3",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 3],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/3",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/3"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/3"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/4",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 4],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/4",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/4"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/4"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/5",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 5],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/5",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/5"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/5"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/6",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 6],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/6",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/6"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/6"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/7",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 7],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/7",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/7"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/7"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/8",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 8],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/8",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/8"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/8"],
    },
    {
        "oid": "2020-05-08T09:27:47_-9_0/0/9",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 9],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/9",
        "lg_key": -9,
        "dt": "memory",
        "nm": "link",
        "producers": ["2020-05-08T09:27:47_-3_0/0/9"],
        "consumers": ["2020-05-08T09:27:47_-2_0/0/9"],
    },
    {
        "oid": "2020-05-08T09:27:47_-5_0/0/0",
        "type": "plain",
        "storage": "memory",
        "rank": [0, 0, 0],
        "loop_cxt": None,
        "dw": 5,
        "iid": "0/0/0",
        "lg_key": -5,
        "dt": "memory",
        "nm": "Memory",
        "producers": ["2020-05-08T09:27:47_-10_0/0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-6_0/0",
        "type": "app",
        "app": "test.graphsRepository",
        "rank": [0, 0],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "mkn": [1, 10, 1],
        "iid": "0/0",
        "lg_key": -6,
        "dt": "Component",
        "nm": "mkn_in",
        "outputs": [
            "2020-05-08T09:27:47_-8_0/0/0",
            "2020-05-08T09:27:47_-8_0/0/1",
            "2020-05-08T09:27:47_-8_0/0/2",
            "2020-05-08T09:27:47_-8_0/0/3",
            "2020-05-08T09:27:47_-8_0/0/4",
            "2020-05-08T09:27:47_-8_0/0/5",
            "2020-05-08T09:27:47_-8_0/0/6",
            "2020-05-08T09:27:47_-8_0/0/7",
            "2020-05-08T09:27:47_-8_0/0/8",
            "2020-05-08T09:27:47_-8_0/0/9",
        ],
        "inputs": ["2020-05-08T09:27:47_-4_0"],
    },
    {
        "oid": "2020-05-08T09:27:47_-10_0/0",
        "type": "app",
        "app": "test.graphsRepository",
        "rank": [0, 0],
        "loop_cxt": None,
        "tw": 5,
        "num_cpus": 1,
        "mkn": [1, 10, 1],
        "iid": "0/0",
        "lg_key": -10,
        "dt": "Component",
        "nm": "mkn_out",
        "outputs": ["2020-05-08T09:27:47_-5_0/0/0"],
        "inputs": [
            "2020-05-08T09:27:47_-1_0/0/0",
            "2020-05-08T09:27:47_-1_0/0/1",
            "2020-05-08T09:27:47_-1_0/0/2",
            "2020-05-08T09:27:47_-1_0/0/3",
            "2020-05-08T09:27:47_-1_0/0/4",
            "2020-05-08T09:27:47_-1_0/0/5",
            "2020-05-08T09:27:47_-1_0/0/6",
            "2020-05-08T09:27:47_-1_0/0/7",
            "2020-05-08T09:27:47_-1_0/0/8",
            "2020-05-08T09:27:47_-1_0/0/9",
        ],
    },
]

REQUEST_FORM = {
    "algo": "simple",
    "lg_name": "simple_01_basic.graph",
    "json_data": None,
    "num_islands": "0",
    "num_par": "1",
    "par_label": "Partition",
    "max_load_imb": "100",
    "max_cpu": "8",
    "num_parallel_task_streams": "1",
}


class TestSimpleLogicalGraphToPhysicalGraphTemples(unittest.TestCase):
    def test_01(self):
        request_form = FormsDict(REQUEST_FORM, json_data=TEST_01_SIMPLE_IN)
        pgt = simple_translator.logical_graph_to_physical_graph_template(
            request_form["json_data"], timestamp="2020-05-08T08:39:41"
        )

        self.assertEqual(pgt, TEST_01_SIMPLE_PGT)
